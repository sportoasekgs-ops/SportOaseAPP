{"file_contents":{"README.md":{"content":"# SportOase Buchungssystem\n\nEine Web-Anwendung zur Verwaltung von Buchungen für die Schul-SportOase mit Login-System und E-Mail-Benachrichtigungen.\n\n## Funktionen\n\n- **Benutzer-Authentifizierung**: Login-System für Lehrkräfte und Admins\n- **Wochenplan-Anzeige**: Übersicht über feste und freie Zeitslots\n- **Buchungssystem**: Lehrkräfte können 1-5 Schüler für Zeitslots anmelden\n- **Kapazitätskontrolle**: Maximal 5 Schüler pro Zeitslot\n- **Vorlaufzeit**: Buchungen nur bis 60 Minuten vor Stundenbeginn möglich\n- **E-Mail-Benachrichtigungen**: Automatische Benachrichtigung bei neuen Buchungen\n- **Admin-Panel**: Verwaltung von Lehrkräften und Übersicht aller Buchungen\n\n## Installation auf Replit\n\n### 1. Projekt starten\n\nDas Projekt verwendet Python 3.11 und Flask. Die Abhängigkeiten werden automatisch installiert.\n\n### 2. Datenbank initialisieren\n\nVor der ersten Nutzung muss die Datenbank initialisiert werden:\n\n```bash\npython db_setup.py\n```\n\nDies erstellt:\n- Die SQLite-Datenbank `sportoase.db`\n- Einen Standard-Admin-Account:\n  - **E-Mail**: admin@sportoase.de\n  - **Passwort**: admin123\n\n**WICHTIG**: Ändern Sie das Admin-Passwort nach dem ersten Login!\n\n### 3. Anwendung starten\n\n```bash\npython app.py\n```\n\nDie Anwendung läuft dann auf Port 5000 und ist über den Replit-Webview erreichbar.\n\n## Umgebungsvariablen (Optional)\n\nFür E-Mail-Benachrichtigungen können folgende Umgebungsvariablen in Replit konfiguriert werden:\n\n- `SMTP_HOST`: SMTP-Server-Adresse (z.B. smtp.gmail.com)\n- `SMTP_PORT`: SMTP-Port (Standard: 587)\n- `SMTP_USER`: SMTP-Benutzername\n- `SMTP_PASS`: SMTP-Passwort\n- `SMTP_FROM`: Absender-E-Mail-Adresse\n- `ADMIN_EMAIL`: E-Mail-Adresse für Benachrichtigungen\n\nOhne SMTP-Konfiguration werden Benachrichtigungen nur in der Konsole ausgegeben.\n\n## Projektstruktur\n\n```\n.\n├── app.py                  # Haupt-Anwendung mit allen Routen\n├── config.py               # Konfiguration (Stundenplan, SMTP, etc.)\n├── models.py               # Datenbank-Modelle und Funktionen\n├── db_setup.py             # Datenbank-Initialisierung\n├── email_service.py        # E-Mail-Versand\n├── templates/              # HTML-Templates\n│   ├── base.html          # Basis-Template\n│   ├── login.html         # Login-Seite\n│   ├── dashboard.html     # Hauptseite mit Wochenplan\n│   ├── book.html          # Buchungsformular\n│   └── admin.html         # Admin-Bereich\n├── static/                 # Statische Dateien\n│   └── style.css          # CSS-Stylesheet\n└── README.md              # Diese Datei\n```\n\n## Nutzung\n\n### Als Admin\n\n1. Login mit Admin-Zugangsdaten\n2. Navigieren zum Admin-Bereich\n3. Neue Lehrkräfte anlegen\n4. Alle Buchungen einsehen und filtern\n\n### Als Lehrkraft\n\n1. Login mit eigenen Zugangsdaten\n2. Datum im Dashboard auswählen\n3. Verfügbare Zeitslots mit \"Buchen\" öffnen\n4. Anzahl Schüler auswählen (1-5)\n5. Schülerdaten eingeben (Name und Klasse)\n6. Bei freien Slots: Modul auswählen\n7. Buchung abschließen\n\n## Wochenplan-Struktur\n\nDie SportOase läuft während der Unterrichtszeit (1.-6. Stunde):\n\n- **1. Stunde**: 07:50 - 08:35\n- **2. Stunde**: 08:35 - 09:20\n- **3. Stunde**: 09:40 - 10:25\n- **4. Stunde**: 10:25 - 11:20\n- **5. Stunde**: 11:40 - 12:25\n- **6. Stunde**: 12:25 - 13:10\n\n### Feste Angebote\n\nDie Konfiguration in `config.py` definiert feste Angebote pro Wochentag:\n\n- **Montag**: Stunden 1, 3, 5 fest\n- **Dienstag**: Alle Stunden frei\n- **Mittwoch**: Stunden 1, 3, 5 fest\n- **Donnerstag**: Stunden 2, 5 fest\n- **Freitag**: Stunden 2, 4, 5 fest\n\nFreie Stunden können mit folgenden Modulen gebucht werden:\n- Aktivierung\n- Regulation / Entspannung\n- Konflikt-Reset\n- Egal / flexibel\n\n## Anpassungen\n\n### Stundenplan ändern\n\nIn `config.py` können Sie anpassen:\n\n- `PERIOD_TIMES`: Zeiten der Schulstunden\n- `FIXED_OFFERS`: Feste Angebote pro Wochentag\n- `FREE_MODULES`: Verfügbare Module für freie Stunden\n- `MAX_STUDENTS_PER_PERIOD`: Maximale Schüleranzahl\n- `BOOKING_ADVANCE_MINUTES`: Vorlaufzeit für Buchungen\n\n### Datenbank zurücksetzen\n\nUm die Datenbank komplett zurückzusetzen:\n\n```bash\nrm sportoase.db\npython db_setup.py\n```\n\n## Technologie-Stack\n\n- **Backend**: Python 3.11, Flask\n- **Datenbank**: SQLite\n- **Templates**: Jinja2\n- **Styling**: Einfaches CSS (schwarz-weiß)\n- **E-Mail**: SMTP (smtplib)\n- **Zeitzone**: Europe/Berlin (pytz)\n\n## Support\n\nBei Fragen oder Problemen wenden Sie sich an Ihren Administrator.\n","size_bytes":4493},"models.py":{"content":"# Datenbankmodelle für die SportOase-Anwendung\n# Diese Datei definiert die Struktur der Datenbank-Tabellen\n\nimport sqlite3\nimport json\nfrom datetime import datetime\nfrom werkzeug.security import generate_password_hash, check_password_hash\nfrom config import DATABASE_PATH\n\ndef get_db():\n    \"\"\"Erstellt eine Verbindung zur SQLite-Datenbank\"\"\"\n    conn = sqlite3.connect(DATABASE_PATH)\n    conn.row_factory = sqlite3.Row  # Ermöglicht Zugriff auf Spalten per Name\n    return conn\n\ndef init_db():\n    \"\"\"Initialisiert die Datenbank und erstellt alle Tabellen\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    \n    # Tabelle für Benutzer (Lehrkräfte und Admins)\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            email TEXT UNIQUE NOT NULL,\n            password_hash TEXT NOT NULL,\n            role TEXT NOT NULL CHECK(role IN ('teacher', 'admin'))\n        )\n    ''')\n    \n    # Tabelle für Buchungen\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS bookings (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            date TEXT NOT NULL,\n            weekday TEXT NOT NULL,\n            period INTEGER NOT NULL CHECK(period >= 1 AND period <= 6),\n            teacher_id INTEGER NOT NULL,\n            teacher_name TEXT,\n            teacher_class TEXT,\n            students_json TEXT NOT NULL,\n            offer_type TEXT NOT NULL CHECK(offer_type IN ('fest', 'frei')),\n            offer_label TEXT NOT NULL,\n            created_at TEXT NOT NULL,\n            FOREIGN KEY (teacher_id) REFERENCES users(id)\n        )\n    ''')\n    \n    # Migriere bestehende Tabelle falls nötig (füge neue Spalten hinzu)\n    try:\n        cursor.execute(\"ALTER TABLE bookings ADD COLUMN teacher_name TEXT\")\n    except sqlite3.OperationalError:\n        pass  # Spalte existiert bereits\n    \n    try:\n        cursor.execute(\"ALTER TABLE bookings ADD COLUMN teacher_class TEXT\")\n    except sqlite3.OperationalError:\n        pass  # Spalte existiert bereits\n    \n    conn.commit()\n    conn.close()\n    print(\"Datenbank erfolgreich initialisiert!\")\n\n# Funktionen für Benutzer-Verwaltung\ndef create_user(email, password, role):\n    \"\"\"Erstellt einen neuen Benutzer in der Datenbank\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    password_hash = generate_password_hash(password)\n    \n    try:\n        cursor.execute(\n            'INSERT INTO users (email, password_hash, role) VALUES (?, ?, ?)',\n            (email, password_hash, role)\n        )\n        conn.commit()\n        user_id = cursor.lastrowid\n        conn.close()\n        return user_id\n    except sqlite3.IntegrityError:\n        conn.close()\n        return None  # E-Mail existiert bereits\n\ndef get_user_by_email(email):\n    \"\"\"Sucht einen Benutzer anhand der E-Mail-Adresse\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('SELECT * FROM users WHERE email = ?', (email,))\n    user = cursor.fetchone()\n    conn.close()\n    return user\n\ndef get_user_by_id(user_id):\n    \"\"\"Sucht einen Benutzer anhand der ID\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('SELECT * FROM users WHERE id = ?', (user_id,))\n    user = cursor.fetchone()\n    conn.close()\n    return user\n\ndef verify_password(user, password):\n    \"\"\"Überprüft, ob das eingegebene Passwort korrekt ist\"\"\"\n    return check_password_hash(user['password_hash'], password)\n\ndef get_all_users():\n    \"\"\"Gibt alle Benutzer zurück (für Admin-Ansicht)\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('SELECT id, email, role FROM users ORDER BY role, email')\n    users = cursor.fetchall()\n    conn.close()\n    return users\n\n# Funktionen für Buchungs-Verwaltung\ndef create_booking(date, weekday, period, teacher_id, students, offer_type, offer_label, teacher_name=None, teacher_class=None):\n    \"\"\"Erstellt eine neue Buchung in der Datenbank\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    \n    students_json = json.dumps(students, ensure_ascii=False)\n    created_at = datetime.now().isoformat()\n    \n    cursor.execute('''\n        INSERT INTO bookings (date, weekday, period, teacher_id, teacher_name, teacher_class, students_json, offer_type, offer_label, created_at)\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ''', (date, weekday, period, teacher_id, teacher_name, teacher_class, students_json, offer_type, offer_label, created_at))\n    \n    conn.commit()\n    booking_id = cursor.lastrowid\n    conn.close()\n    return booking_id\n\ndef get_bookings_for_date_period(date, period):\n    \"\"\"Gibt alle Buchungen für ein bestimmtes Datum und Stunde zurück\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('''\n        SELECT * FROM bookings \n        WHERE date = ? AND period = ?\n        ORDER BY created_at\n    ''', (date, period))\n    bookings = cursor.fetchall()\n    conn.close()\n    return bookings\n\ndef count_students_for_period(date, period):\n    \"\"\"Zählt die Gesamtzahl der Schüler für eine bestimmte Stunde\"\"\"\n    bookings = get_bookings_for_date_period(date, period)\n    total = 0\n    for booking in bookings:\n        students = json.loads(booking['students_json'])\n        total += len(students)\n    return total\n\ndef get_all_bookings():\n    \"\"\"Gibt alle Buchungen zurück (für Admin-Ansicht)\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('''\n        SELECT b.*, u.email as teacher_email \n        FROM bookings b\n        JOIN users u ON b.teacher_id = u.id\n        ORDER BY b.date DESC, b.period\n    ''')\n    bookings = cursor.fetchall()\n    conn.close()\n    return bookings\n\ndef get_bookings_by_date(date):\n    \"\"\"Gibt alle Buchungen für ein bestimmtes Datum zurück\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('''\n        SELECT b.*, u.email as teacher_email \n        FROM bookings b\n        JOIN users u ON b.teacher_id = u.id\n        WHERE b.date = ?\n        ORDER BY b.period\n    ''', (date,))\n    bookings = cursor.fetchall()\n    conn.close()\n    return bookings\n\ndef get_bookings_for_week(start_date, end_date):\n    \"\"\"Gibt alle Buchungen für eine Woche zurück\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('''\n        SELECT b.*, u.email as teacher_email \n        FROM bookings b\n        JOIN users u ON b.teacher_id = u.id\n        WHERE b.date >= ? AND b.date <= ?\n        ORDER BY b.date, b.period\n    ''', (start_date, end_date))\n    bookings = cursor.fetchall()\n    conn.close()\n    return bookings\n\ndef get_booking_by_id(booking_id):\n    \"\"\"Gibt eine einzelne Buchung anhand der ID zurück\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('''\n        SELECT b.*, u.email as teacher_email \n        FROM bookings b\n        JOIN users u ON b.teacher_id = u.id\n        WHERE b.id = ?\n    ''', (booking_id,))\n    booking = cursor.fetchone()\n    conn.close()\n    return booking\n\ndef update_booking(booking_id, date, weekday, period, teacher_id, students, offer_type, offer_label, teacher_name=None, teacher_class=None):\n    \"\"\"Aktualisiert eine bestehende Buchung in der Datenbank\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    \n    students_json = json.dumps(students, ensure_ascii=False)\n    \n    cursor.execute('''\n        UPDATE bookings \n        SET date = ?, weekday = ?, period = ?, teacher_id = ?, teacher_name = ?, teacher_class = ?, \n            students_json = ?, offer_type = ?, offer_label = ?\n        WHERE id = ?\n    ''', (date, weekday, period, teacher_id, teacher_name, teacher_class, students_json, offer_type, offer_label, booking_id))\n    \n    conn.commit()\n    affected = cursor.rowcount\n    conn.close()\n    return affected > 0\n\ndef delete_booking(booking_id):\n    \"\"\"Löscht eine Buchung aus der Datenbank\"\"\"\n    conn = get_db()\n    cursor = conn.cursor()\n    cursor.execute('DELETE FROM bookings WHERE id = ?', (booking_id,))\n    conn.commit()\n    affected = cursor.rowcount\n    conn.close()\n    return affected > 0\n","size_bytes":7944},"app.py":{"content":"# Haupt-Anwendungsdatei für die SportOase-Buchungssystem\n# Diese Datei enthält alle Routen (URLs) und die Logik der Webanwendung\n\nfrom flask import Flask, render_template, request, redirect, url_for, session, flash\nfrom datetime import datetime, timedelta, date\nimport pytz\nimport json\n\n# Importiere unsere eigenen Module\nfrom config import *\nfrom models import *\nfrom email_service import send_booking_notification\n\n# Flask-App erstellen\napp = Flask(__name__)\napp.secret_key = SECRET_KEY\n\n# Hilfsfunktion: Zeitzone Europe/Berlin\ndef get_berlin_tz():\n    \"\"\"Gibt die Zeitzone Europe/Berlin zurück\"\"\"\n    return pytz.timezone('Europe/Berlin')\n\n# Hilfsfunktion: Prüft, ob Benutzer eingeloggt ist\ndef login_required(f):\n    \"\"\"Decorator-Funktion: Schützt Routen, sodass nur eingeloggte Benutzer darauf zugreifen können\"\"\"\n    from functools import wraps\n    @wraps(f)\n    def decorated_function(*args, **kwargs):\n        if 'user_id' not in session:\n            flash('Bitte melden Sie sich an.', 'error')\n            return redirect(url_for('login'))\n        return f(*args, **kwargs)\n    return decorated_function\n\n# Hilfsfunktion: Prüft, ob Benutzer Admin ist\ndef admin_required(f):\n    \"\"\"Decorator-Funktion: Schützt Routen, sodass nur Admins darauf zugreifen können\"\"\"\n    from functools import wraps\n    @wraps(f)\n    def decorated_function(*args, **kwargs):\n        if 'user_id' not in session:\n            flash('Bitte melden Sie sich an.', 'error')\n            return redirect(url_for('login'))\n        user = get_user_by_id(session['user_id'])\n        if not user or user['role'] != 'admin':\n            flash('Zugriff verweigert. Nur Admins haben Zugriff.', 'error')\n            return redirect(url_for('dashboard'))\n        return f(*args, **kwargs)\n    return decorated_function\n\n# Hilfsfunktion: Gibt Informationen über eine Stunde zurück\ndef get_period_info(weekday, period):\n    \"\"\"\n    Gibt Informationen über eine Stunde zurück (fest/frei, Bezeichnung)\n    weekday: z.B. \"Mon\", \"Tue\", ...\n    period: 1-6\n    \"\"\"\n    if weekday in FIXED_OFFERS and period in FIXED_OFFERS[weekday]:\n        return {\n            'type': 'fest',\n            'label': FIXED_OFFERS[weekday][period]\n        }\n    else:\n        return {\n            'type': 'frei',\n            'label': 'Freie Wahl'\n        }\n\n# Hilfsfunktion: Prüft, ob eine Buchung zeitlich möglich ist\ndef check_booking_time(booking_date, period):\n    \"\"\"\n    Prüft, ob die Buchung mindestens 60 Minuten in der Zukunft liegt\n    Gibt (True, None) zurück wenn OK, sonst (False, Fehlermeldung)\n    \"\"\"\n    berlin_tz = get_berlin_tz()\n    now = datetime.now(berlin_tz)\n    \n    # Erstelle Datetime-Objekt für den Stundenbeginn\n    period_start_time = PERIOD_TIMES[period]['start']\n    hour, minute = map(int, period_start_time.split(':'))\n    \n    # Kombiniere Datum und Zeit\n    period_datetime = berlin_tz.localize(\n        datetime.combine(booking_date, datetime.min.time()).replace(hour=hour, minute=minute)\n    )\n    \n    # Berechne Zeitdifferenz\n    time_diff = period_datetime - now\n    \n    if time_diff.total_seconds() < BOOKING_ADVANCE_MINUTES * 60:\n        return False, f\"Buchungen sind nur bis {BOOKING_ADVANCE_MINUTES} Minuten vor Stundenbeginn möglich.\"\n    \n    return True, None\n\n# Route: Startseite (leitet zum Dashboard weiter)\n@app.route('/')\ndef index():\n    \"\"\"Startseite - leitet zum Dashboard oder Login weiter\"\"\"\n    if 'user_id' in session:\n        return redirect(url_for('dashboard'))\n    return redirect(url_for('login'))\n\n# Route: Login-Seite\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    \"\"\"Login-Seite für Lehrkräfte und Admins\"\"\"\n    if request.method == 'POST':\n        email = request.form.get('email', '').strip()\n        password = request.form.get('password', '')\n        \n        # Suche Benutzer in Datenbank\n        user = get_user_by_email(email)\n        \n        if user and verify_password(user, password):\n            # Login erfolgreich - speichere in Session\n            session['user_id'] = user['id']\n            session['user_email'] = user['email']\n            session['user_role'] = user['role']\n            flash(f'Willkommen, {email}!', 'success')\n            return redirect(url_for('dashboard'))\n        else:\n            flash('Ungültige E-Mail oder Passwort.', 'error')\n    \n    return render_template('login.html')\n\n# Route: Logout\n@app.route('/logout')\ndef logout():\n    \"\"\"Meldet den Benutzer ab\"\"\"\n    session.clear()\n    flash('Sie wurden abgemeldet.', 'info')\n    return redirect(url_for('login'))\n\n# Route: Dashboard\n@app.route('/dashboard')\n@login_required\ndef dashboard():\n    \"\"\"Hauptseite - zeigt Wochenplan und Buchungsmöglichkeiten\"\"\"\n    # Hole aktuelles Datum oder gewähltes Datum\n    selected_date_str = request.args.get('date', datetime.now(get_berlin_tz()).strftime('%Y-%m-%d'))\n    \n    try:\n        selected_date = datetime.strptime(selected_date_str, '%Y-%m-%d').date()\n    except:\n        selected_date = datetime.now(get_berlin_tz()).date()\n    \n    # Wochentag ermitteln (Mon, Tue, ...)\n    weekday = selected_date.strftime('%a')\n    weekday_name = selected_date.strftime('%A')  # Ausgeschriebener Name\n    \n    # Deutsche Wochentagsnamen\n    weekday_names_de = {\n        'Monday': 'Montag',\n        'Tuesday': 'Dienstag',\n        'Wednesday': 'Mittwoch',\n        'Thursday': 'Donnerstag',\n        'Friday': 'Freitag',\n        'Saturday': 'Samstag',\n        'Sunday': 'Sonntag'\n    }\n    weekday_name_de = weekday_names_de.get(weekday_name, weekday_name)\n    \n    # Erstelle Stundenplan für den Tag\n    schedule = []\n    for period in range(1, 7):\n        period_info = get_period_info(weekday, period)\n        student_count = count_students_for_period(selected_date_str, period)\n        available = MAX_STUDENTS_PER_PERIOD - student_count\n        \n        # Prüfe, ob Buchung zeitlich möglich ist\n        can_book, time_message = check_booking_time(selected_date, period)\n        \n        schedule.append({\n            'period': period,\n            'time': f\"{PERIOD_TIMES[period]['start']} - {PERIOD_TIMES[period]['end']}\",\n            'type': period_info['type'],\n            'label': period_info['label'],\n            'booked': student_count,\n            'available': available,\n            'can_book': can_book and available > 0,\n            'time_message': time_message\n        })\n    \n    # Erstelle Wochenübersicht (Montag-Freitag) mit Buchungsdaten\n    from models import get_bookings_for_week\n    \n    # Berechne Montag und Freitag der aktuellen Woche\n    days_since_monday = selected_date.weekday()\n    monday = selected_date - timedelta(days=days_since_monday)\n    friday = monday + timedelta(days=4)\n    \n    # Hole alle Buchungen für diese Woche\n    week_bookings = get_bookings_for_week(monday.strftime('%Y-%m-%d'), friday.strftime('%Y-%m-%d'))\n    \n    # Organisiere Buchungen nach Datum und Stunde\n    bookings_by_date_period = {}\n    for booking in week_bookings:\n        booking_dict = dict(booking)\n        key = f\"{booking_dict['date']}_{booking_dict['period']}\"\n        if key not in bookings_by_date_period:\n            bookings_by_date_period[key] = []\n        \n        students = json.loads(booking_dict['students_json']) if booking_dict.get('students_json') else []\n        bookings_by_date_period[key].append({\n            'teacher_name': booking_dict.get('teacher_name', 'N/A'),\n            'teacher_class': booking_dict.get('teacher_class', 'N/A'),\n            'student_count': len(students),\n            'students': students\n        })\n    \n    week_overview = []\n    weekdays = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri']\n    weekday_names = ['Mo', 'Di', 'Mi', 'Do', 'Fr']\n    \n    for i, wd in enumerate(weekdays):\n        day_date = monday + timedelta(days=i)\n        day_date_str = day_date.strftime('%Y-%m-%d')\n        \n        day_schedule = []\n        for period in range(1, 7):\n            info = get_period_info(wd, period)\n            key = f\"{day_date_str}_{period}\"\n            period_bookings = bookings_by_date_period.get(key, [])\n            \n            total_students = sum(b['student_count'] for b in period_bookings)\n            \n            day_schedule.append({\n                'period': period,\n                'type': info['type'],\n                'label': info['label'],\n                'bookings': period_bookings,\n                'total_students': total_students\n            })\n        week_overview.append({\n            'weekday': wd,\n            'name': weekday_names[i],\n            'date': day_date_str,\n            'schedule': day_schedule\n        })\n    \n    return render_template('dashboard.html',\n                         selected_date=selected_date,\n                         weekday=weekday_name_de,\n                         schedule=schedule,\n                         week_overview=week_overview,\n                         user_role=session.get('user_role'))\n\n# Route: Buchungsseite\n@app.route('/book/<date_str>/<int:period>', methods=['GET', 'POST'])\n@login_required\ndef book(date_str, period):\n    \"\"\"Seite zum Erstellen einer neuen Buchung\"\"\"\n    \n    # Validiere Datum und Stunde\n    try:\n        booking_date = datetime.strptime(date_str, '%Y-%m-%d').date()\n    except:\n        flash('Ungültiges Datum.', 'error')\n        return redirect(url_for('dashboard'))\n    \n    if period < 1 or period > 6:\n        flash('Ungültige Stunde.', 'error')\n        return redirect(url_for('dashboard'))\n    \n    # Ermittle Wochentag und Stundeninfo\n    weekday = booking_date.strftime('%a')\n    period_info = get_period_info(weekday, period)\n    \n    # Prüfe verfügbare Plätze\n    current_students = count_students_for_period(date_str, period)\n    available_spots = MAX_STUDENTS_PER_PERIOD - current_students\n    \n    if available_spots <= 0:\n        flash('Diese Stunde ist bereits voll belegt.', 'error')\n        return redirect(url_for('dashboard', date=date_str))\n    \n    # Prüfe Zeitfenster\n    can_book, time_message = check_booking_time(booking_date, period)\n    if not can_book:\n        flash(time_message or 'Buchung nicht möglich.', 'error')\n        return redirect(url_for('dashboard', date=date_str))\n    \n    if request.method == 'POST':\n        # Hole Lehrkraft-Informationen\n        teacher_name = request.form.get('teacher_name', '').strip()\n        teacher_class = request.form.get('teacher_class', '').strip()\n        \n        if not teacher_name or not teacher_class:\n            flash('Bitte geben Sie Ihren Namen und Ihre Klasse ein.', 'error')\n            return render_template('book.html', \n                                 date_str=date_str,\n                                 period=period,\n                                 period_info=period_info,\n                                 period_time=PERIOD_TIMES[period],\n                                 available_spots=available_spots,\n                                 free_modules=FREE_MODULES)\n        \n        # Hole Anzahl der Schüler\n        num_students = int(request.form.get('num_students', 1))\n        \n        if num_students < 1 or num_students > 5:\n            flash('Bitte wählen Sie zwischen 1 und 5 Schülern.', 'error')\n            return render_template('book.html', \n                                 date_str=date_str,\n                                 period=period,\n                                 period_info=period_info,\n                                 period_time=PERIOD_TIMES[period],\n                                 available_spots=available_spots,\n                                 free_modules=FREE_MODULES)\n        \n        # Prüfe erneut verfügbare Plätze\n        if num_students > available_spots:\n            flash(f'Nicht genug Plätze verfügbar. Nur noch {available_spots} Plätze frei.', 'error')\n            return redirect(url_for('dashboard', date=date_str))\n        \n        # Sammle Schülerdaten\n        students = []\n        for i in range(num_students):\n            name = request.form.get(f'student_name_{i}', '').strip()\n            klasse = request.form.get(f'student_class_{i}', '').strip()\n            \n            if not name or not klasse:\n                flash('Bitte füllen Sie alle Schülerfelder aus.', 'error')\n                return render_template('book.html', \n                                     date_str=date_str,\n                                     period=period,\n                                     period_info=period_info,\n                                     period_time=PERIOD_TIMES[period],\n                                     available_spots=available_spots,\n                                     free_modules=FREE_MODULES)\n            \n            students.append({'name': name, 'klasse': klasse})\n        \n        # Hole Modul-Wahl (nur bei freien Stunden)\n        if period_info['type'] == 'frei':\n            selected_module = request.form.get('module', '')\n            if selected_module not in FREE_MODULES:\n                flash('Bitte wählen Sie ein Modul.', 'error')\n                return render_template('book.html', \n                                     date_str=date_str,\n                                     period=period,\n                                     period_info=period_info,\n                                     period_time=PERIOD_TIMES[period],\n                                     available_spots=available_spots,\n                                     free_modules=FREE_MODULES)\n            offer_label = selected_module\n        else:\n            offer_label = period_info['label']\n        \n        # Erstelle Buchung in Datenbank\n        booking_id = create_booking(\n            date=date_str,\n            weekday=weekday,\n            period=period,\n            teacher_id=session['user_id'],\n            students=students,\n            offer_type=period_info['type'],\n            offer_label=offer_label,\n            teacher_name=teacher_name,\n            teacher_class=teacher_class\n        )\n        \n        if booking_id:\n            # Sende E-Mail-Benachrichtigung\n            booking_data = {\n                'date': date_str,\n                'weekday': weekday,\n                'period': period,\n                'students': students,\n                'offer_type': period_info['type'],\n                'offer_label': offer_label,\n                'teacher_name': teacher_name,\n                'teacher_class': teacher_class\n            }\n            send_booking_notification(booking_data, session.get('user_email', 'system'))\n            \n            flash(f'Buchung erfolgreich! {len(students)} Schüler für {offer_label} angemeldet.', 'success')\n            return redirect(url_for('dashboard', date=date_str))\n        else:\n            flash('Fehler beim Erstellen der Buchung.', 'error')\n    \n    return render_template('book.html',\n                         date_str=date_str,\n                         period=period,\n                         period_info=period_info,\n                         period_time=PERIOD_TIMES[period],\n                         available_spots=available_spots,\n                         free_modules=FREE_MODULES)\n\n# Route: Admin-Bereich\n@app.route('/admin', methods=['GET', 'POST'])\n@admin_required\ndef admin():\n    \"\"\"Admin-Seite für Benutzerverwaltung und Buchungsübersicht\"\"\"\n    \n    if request.method == 'POST':\n        # Neue Lehrkraft anlegen\n        email = request.form.get('email', '').strip()\n        password = request.form.get('password', '')\n        \n        if not email or not password:\n            flash('Bitte füllen Sie alle Felder aus.', 'error')\n        else:\n            user_id = create_user(email, password, 'teacher')\n            if user_id:\n                flash(f'Lehrkraft {email} erfolgreich angelegt.', 'success')\n            else:\n                flash('E-Mail-Adresse existiert bereits.', 'error')\n    \n    # Hole alle Benutzer\n    users = get_all_users()\n    \n    # Hole alle Buchungen\n    filter_date = request.args.get('filter_date', '')\n    if filter_date:\n        bookings = get_bookings_by_date(filter_date)\n    else:\n        bookings = get_all_bookings()\n    \n    # Konvertiere Buchungen für Anzeige\n    bookings_display = []\n    for booking in bookings:\n        booking_dict = dict(booking)\n        students = json.loads(booking_dict['students_json']) if booking_dict.get('students_json') else []\n        bookings_display.append({\n            'id': booking_dict['id'],\n            'date': booking_dict['date'],\n            'weekday': booking_dict['weekday'],\n            'period': booking_dict['period'],\n            'teacher_email': booking_dict['teacher_email'],\n            'teacher_name': booking_dict.get('teacher_name', 'N/A'),\n            'teacher_class': booking_dict.get('teacher_class', 'N/A'),\n            'offer_label': booking_dict['offer_label'],\n            'offer_type': booking_dict['offer_type'],\n            'students': students,\n            'student_count': len(students)\n        })\n    \n    return render_template('admin.html',\n                         users=users,\n                         bookings=bookings_display,\n                         filter_date=filter_date)\n\n# Route: Buchung erstellen (nur Admin)\n@app.route('/admin/create_booking', methods=['GET', 'POST'])\n@admin_required\ndef admin_create_booking():\n    \"\"\"Admin kann Buchungen für beliebige Lehrkräfte erstellen\"\"\"\n    from models import get_booking_by_id\n    \n    if request.method == 'POST':\n        date_str = request.form.get('date', '').strip()\n        \n        try:\n            period = int(request.form.get('period', 1))\n            teacher_id = int(request.form.get('teacher_id', 0))\n            num_students = int(request.form.get('num_students', 1))\n        except (ValueError, TypeError):\n            flash('Ungültige Eingabe für Stunde, Lehrkraft oder Schüleranzahl.', 'error')\n            users = get_all_users()\n            return render_template('admin_edit_booking.html',\n                                 booking=None,\n                                 users=users,\n                                 free_modules=FREE_MODULES,\n                                 period_times=PERIOD_TIMES)\n        \n        teacher_name = request.form.get('teacher_name', '').strip()\n        teacher_class = request.form.get('teacher_class', '').strip()\n        \n        if not date_str or not teacher_id or not teacher_name or not teacher_class or num_students < 1 or num_students > 5:\n            flash('Bitte füllen Sie alle Pflichtfelder aus und wählen Sie 1-5 Schüler.', 'error')\n            users = get_all_users()\n            return render_template('admin_edit_booking.html',\n                                 booking=None,\n                                 users=users,\n                                 free_modules=FREE_MODULES,\n                                 period_times=PERIOD_TIMES)\n        \n        try:\n            booking_date = datetime.strptime(date_str, '%Y-%m-%d').date()\n        except:\n            flash('Ungültiges Datum.', 'error')\n            users = get_all_users()\n            return render_template('admin_edit_booking.html',\n                                 booking=None,\n                                 users=users,\n                                 free_modules=FREE_MODULES,\n                                 period_times=PERIOD_TIMES)\n        \n        weekday = booking_date.strftime('%a')\n        period_info = get_period_info(weekday, period)\n        \n        # Prüfe Kapazität vor dem Erstellen der Buchung\n        current_students = count_students_for_period(date_str, period)\n        available_spots = MAX_STUDENTS_PER_PERIOD - current_students\n        \n        if num_students > available_spots:\n            flash(f'Nicht genug Plätze verfügbar. Nur noch {available_spots} Plätze frei.', 'error')\n            users = get_all_users()\n            return render_template('admin_edit_booking.html',\n                                 booking=None,\n                                 users=users,\n                                 free_modules=FREE_MODULES,\n                                 period_times=PERIOD_TIMES)\n        \n        students = []\n        for i in range(num_students):\n            name = request.form.get(f'student_name_{i}', '').strip()\n            klasse = request.form.get(f'student_class_{i}', '').strip()\n            \n            if not name or not klasse:\n                flash('Bitte füllen Sie alle Schülerfelder aus.', 'error')\n                users = get_all_users()\n                return render_template('admin_edit_booking.html',\n                                     booking=None,\n                                     users=users,\n                                     free_modules=FREE_MODULES,\n                                     period_times=PERIOD_TIMES)\n            \n            students.append({'name': name, 'klasse': klasse})\n        \n        if period_info['type'] == 'frei':\n            selected_module = request.form.get('module', '')\n            if selected_module not in FREE_MODULES:\n                flash('Bitte wählen Sie ein Modul.', 'error')\n                users = get_all_users()\n                return render_template('admin_edit_booking.html',\n                                     booking=None,\n                                     users=users,\n                                     free_modules=FREE_MODULES,\n                                     period_times=PERIOD_TIMES)\n            offer_label = selected_module\n        else:\n            offer_label = period_info['label']\n        \n        booking_id = create_booking(\n            date=date_str,\n            weekday=weekday,\n            period=period,\n            teacher_id=teacher_id,\n            students=students,\n            offer_type=period_info['type'],\n            offer_label=offer_label,\n            teacher_name=teacher_name,\n            teacher_class=teacher_class\n        )\n        \n        if booking_id:\n            flash(f'Buchung erfolgreich erstellt! {len(students)} Schüler für {offer_label} angemeldet.', 'success')\n            return redirect(url_for('admin'))\n        else:\n            flash('Fehler beim Erstellen der Buchung.', 'error')\n    \n    users = get_all_users()\n    return render_template('admin_edit_booking.html',\n                         booking=None,\n                         users=users,\n                         free_modules=FREE_MODULES,\n                         period_times=PERIOD_TIMES)\n\n# Route: Buchung bearbeiten (nur Admin)\n@app.route('/admin/edit_booking/<int:booking_id>', methods=['GET', 'POST'])\n@admin_required\ndef admin_edit_booking(booking_id):\n    \"\"\"Admin kann bestehende Buchungen bearbeiten\"\"\"\n    from models import get_booking_by_id, update_booking\n    \n    booking_row = get_booking_by_id(booking_id)\n    if not booking_row:\n        flash('Buchung nicht gefunden.', 'error')\n        return redirect(url_for('admin'))\n    \n    booking = dict(booking_row)\n    \n    if request.method == 'POST':\n        date_str = request.form.get('date', '').strip()\n        \n        try:\n            period = int(request.form.get('period', 1))\n            teacher_id = int(request.form.get('teacher_id', 0))\n            num_students = int(request.form.get('num_students', 1))\n        except (ValueError, TypeError):\n            flash('Ungültige Eingabe für Stunde, Lehrkraft oder Schüleranzahl.', 'error')\n            users = get_all_users()\n            students = json.loads(booking['students_json']) if booking.get('students_json') else []\n            booking_display = dict(booking)\n            booking_display['students'] = students\n            return render_template('admin_edit_booking.html',\n                                 booking=booking_display,\n                                 users=users,\n                                 free_modules=FREE_MODULES,\n                                 period_times=PERIOD_TIMES)\n        \n        teacher_name = request.form.get('teacher_name', '').strip()\n        teacher_class = request.form.get('teacher_class', '').strip()\n        \n        if not date_str or not teacher_id or not teacher_name or not teacher_class or num_students < 1 or num_students > 5:\n            flash('Bitte füllen Sie alle Pflichtfelder aus und wählen Sie 1-5 Schüler.', 'error')\n            users = get_all_users()\n            students = json.loads(booking['students_json']) if booking.get('students_json') else []\n            booking_display = dict(booking)\n            booking_display['students'] = students\n            return render_template('admin_edit_booking.html',\n                                 booking=booking_display,\n                                 users=users,\n                                 free_modules=FREE_MODULES,\n                                 period_times=PERIOD_TIMES)\n        \n        try:\n            booking_date = datetime.strptime(date_str, '%Y-%m-%d').date()\n        except:\n            flash('Ungültiges Datum.', 'error')\n            users = get_all_users()\n            students = json.loads(booking['students_json']) if booking.get('students_json') else []\n            booking_display = dict(booking)\n            booking_display['students'] = students\n            return render_template('admin_edit_booking.html',\n                                 booking=booking_display,\n                                 users=users,\n                                 free_modules=FREE_MODULES,\n                                 period_times=PERIOD_TIMES)\n        \n        weekday = booking_date.strftime('%a')\n        period_info = get_period_info(weekday, period)\n        \n        # Prüfe Kapazität: Berechne verfügbare Plätze ohne die aktuelle Buchung\n        current_students = count_students_for_period(date_str, period)\n        old_booking_students = len(json.loads(booking['students_json']) if booking.get('students_json') else [])\n        available_spots = MAX_STUDENTS_PER_PERIOD - (current_students - old_booking_students)\n        \n        if num_students > available_spots:\n            flash(f'Nicht genug Plätze verfügbar. Nur noch {available_spots} Plätze frei.', 'error')\n            users = get_all_users()\n            students = json.loads(booking['students_json']) if booking.get('students_json') else []\n            booking_display = dict(booking)\n            booking_display['students'] = students\n            return render_template('admin_edit_booking.html',\n                                 booking=booking_display,\n                                 users=users,\n                                 free_modules=FREE_MODULES,\n                                 period_times=PERIOD_TIMES)\n        \n        students = []\n        for i in range(num_students):\n            name = request.form.get(f'student_name_{i}', '').strip()\n            klasse = request.form.get(f'student_class_{i}', '').strip()\n            \n            if not name or not klasse:\n                flash('Bitte füllen Sie alle Schülerfelder aus.', 'error')\n                users = get_all_users()\n                students = json.loads(booking['students_json']) if booking.get('students_json') else []\n                booking_display = dict(booking)\n                booking_display['students'] = students\n                return render_template('admin_edit_booking.html',\n                                     booking=booking_display,\n                                     users=users,\n                                     free_modules=FREE_MODULES,\n                                     period_times=PERIOD_TIMES)\n            \n            students.append({'name': name, 'klasse': klasse})\n        \n        if period_info['type'] == 'frei':\n            selected_module = request.form.get('module', '')\n            if selected_module not in FREE_MODULES:\n                flash('Bitte wählen Sie ein Modul.', 'error')\n                users = get_all_users()\n                students = json.loads(booking['students_json']) if booking.get('students_json') else []\n                booking_display = dict(booking)\n                booking_display['students'] = students\n                return render_template('admin_edit_booking.html',\n                                     booking=booking_display,\n                                     users=users,\n                                     free_modules=FREE_MODULES,\n                                     period_times=PERIOD_TIMES)\n            offer_label = selected_module\n        else:\n            offer_label = period_info['label']\n        \n        if update_booking(\n            booking_id=booking_id,\n            date=date_str,\n            weekday=weekday,\n            period=period,\n            teacher_id=teacher_id,\n            students=students,\n            offer_type=period_info['type'],\n            offer_label=offer_label,\n            teacher_name=teacher_name,\n            teacher_class=teacher_class\n        ):\n            flash(f'Buchung erfolgreich aktualisiert!', 'success')\n            return redirect(url_for('admin'))\n        else:\n            flash('Fehler beim Aktualisieren der Buchung.', 'error')\n    \n    users = get_all_users()\n    students = json.loads(booking['students_json']) if booking.get('students_json') else []\n    booking_display = dict(booking)\n    booking_display['students'] = students\n    \n    return render_template('admin_edit_booking.html',\n                         booking=booking_display,\n                         users=users,\n                         free_modules=FREE_MODULES,\n                         period_times=PERIOD_TIMES)\n\n# Route: Buchung löschen (nur Admin)\n@app.route('/admin/delete_booking/<int:booking_id>', methods=['POST'])\n@admin_required\ndef delete_booking_route(booking_id):\n    \"\"\"Löscht eine Buchung\"\"\"\n    from models import delete_booking\n    \n    if delete_booking(booking_id):\n        flash('Buchung erfolgreich gelöscht.', 'success')\n    else:\n        flash('Buchung konnte nicht gelöscht werden.', 'error')\n    \n    return redirect(url_for('admin'))\n\nif __name__ == '__main__':\n    # Stelle sicher, dass die Datenbank initialisiert ist\n    init_db()\n    # Starte die Anwendung\n    app.run(host='0.0.0.0', port=5000, debug=True)\n","size_bytes":30045},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"email-validator>=2.3.0\",\n    \"flask>=3.1.2\",\n    \"flask-sqlalchemy>=3.1.1\",\n    \"gunicorn>=23.0.0\",\n    \"psycopg2-binary>=2.9.11\",\n    \"pytz>=2025.2\",\n    \"werkzeug>=3.1.3\",\n]\n","size_bytes":323},"email_service.py":{"content":"# E-Mail-Service für Buchungsbenachrichtigungen\n# Sendet E-Mails über SMTP an Admins und Lehrkräfte\n\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.mime.multipart import MIMEMultipart\nfrom config import SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASS, SMTP_FROM, ADMIN_EMAIL\nimport json\n\ndef send_booking_notification(booking_data, teacher_email):\n    \"\"\"\n    Sendet eine E-Mail-Benachrichtigung über eine neue Buchung\n    \n    booking_data: Dictionary mit Buchungsinformationen\n    teacher_email: E-Mail-Adresse der Lehrkraft\n    \"\"\"\n    \n    # Wenn SMTP nicht konfiguriert ist, Nachricht nur ausgeben\n    if not SMTP_USER or not SMTP_PASS or SMTP_HOST == 'smtp.example.com':\n        print(\"\\n=== E-Mail-Benachrichtigung (SMTP nicht konfiguriert) ===\")\n        print(f\"An: {ADMIN_EMAIL}\")\n        print(f\"Betreff: Neue SportOase-Buchung für {booking_data['date']}\")\n        print(f\"\\nDatum: {booking_data['date']}\")\n        print(f\"Stunde: {booking_data['period']}\")\n        print(f\"Angebot: {booking_data['offer_label']} ({booking_data['offer_type']})\")\n        print(f\"Lehrkraft: {booking_data.get('teacher_name', 'N/A')} (Klasse {booking_data.get('teacher_class', 'N/A')})\")\n        print(f\"Schüler:\")\n        for student in booking_data['students']:\n            print(f\"  - {student['name']} (Klasse {student['klasse']})\")\n        print(\"=\" * 50 + \"\\n\")\n        return True\n    \n    try:\n        # E-Mail-Inhalt erstellen\n        students_list = \"\\n\".join([\n            f\"  - {s['name']} (Klasse {s['klasse']})\" \n            for s in booking_data['students']\n        ])\n        \n        subject = f\"Neue SportOase-Buchung für {booking_data['date']}\"\n        body = f\"\"\"\nNeue Buchung in der SportOase:\n\nDatum: {booking_data['date']} ({booking_data['weekday']})\nStunde: {booking_data['period']}. Stunde\nAngebot: {booking_data['offer_label']} ({booking_data['offer_type']})\nLehrkraft: {booking_data.get('teacher_name', 'N/A')} (Klasse {booking_data.get('teacher_class', 'N/A')})\n\nAngemeldete Schüler:\n{students_list}\n\nAnzahl Schüler: {len(booking_data['students'])}\n\n---\nDiese E-Mail wurde automatisch vom SportOase-Buchungssystem generiert.\n\"\"\"\n        \n        # E-Mail an Admin senden\n        msg = MIMEMultipart()\n        msg['From'] = SMTP_FROM\n        msg['To'] = ADMIN_EMAIL\n        msg['Subject'] = subject\n        msg.attach(MIMEText(body, 'plain', 'utf-8'))\n        \n        # SMTP-Verbindung aufbauen und E-Mail senden\n        server = smtplib.SMTP(SMTP_HOST, SMTP_PORT)\n        server.starttls()\n        server.login(SMTP_USER, SMTP_PASS)\n        server.send_message(msg)\n        server.quit()\n        \n        print(f\"E-Mail-Benachrichtigung an {ADMIN_EMAIL} gesendet.\")\n        \n        # Optional: Bestätigung an Lehrkraft senden\n        send_teacher_confirmation(booking_data, teacher_email)\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Fehler beim E-Mail-Versand: {e}\")\n        return False\n\ndef send_teacher_confirmation(booking_data, teacher_email):\n    \"\"\"Sendet eine Bestätigung an die Lehrkraft\"\"\"\n    \n    if not SMTP_USER or not SMTP_PASS or SMTP_HOST == 'smtp.example.com':\n        return  # SMTP nicht konfiguriert\n    \n    try:\n        students_list = \"\\n\".join([\n            f\"  - {s['name']} (Klasse {s['klasse']})\" \n            for s in booking_data['students']\n        ])\n        \n        subject = f\"Buchungsbestätigung SportOase - {booking_data['date']}\"\n        body = f\"\"\"\nIhre Buchung wurde erfolgreich registriert:\n\nDatum: {booking_data['date']} ({booking_data['weekday']})\nStunde: {booking_data['period']}. Stunde\nAngebot: {booking_data['offer_label']}\n\nAngemeldete Schüler:\n{students_list}\n\nVielen Dank für Ihre Buchung!\n\n---\nDiese E-Mail wurde automatisch vom SportOase-Buchungssystem generiert.\n\"\"\"\n        \n        msg = MIMEMultipart()\n        msg['From'] = SMTP_FROM\n        msg['To'] = teacher_email\n        msg['Subject'] = subject\n        msg.attach(MIMEText(body, 'plain', 'utf-8'))\n        \n        server = smtplib.SMTP(SMTP_HOST, SMTP_PORT)\n        server.starttls()\n        server.login(SMTP_USER, SMTP_PASS)\n        server.send_message(msg)\n        server.quit()\n        \n        print(f\"Bestätigungs-E-Mail an {teacher_email} gesendet.\")\n        \n    except Exception as e:\n        print(f\"Fehler beim Versand der Bestätigung: {e}\")\n","size_bytes":4352},"static/style.css":{"content":"/* \n   SportOase Buchungssystem - Stylesheet\n   Design: Modern mit Logo-Farben (Blau, Sand, Grün)\n*/\n\n:root {\n    --blue-sky: #5DADE2;\n    --blue-dark: #3498DB;\n    --sand: #E8B86D;\n    --sand-light: #F5E6D3;\n    --green: #7FB069;\n    --orange: #FF9500;\n    --dark: #2C3E50;\n    --gray: #7F8C8D;\n    --light-gray: #ECF0F1;\n    --white: #FFFFFF;\n    --shadow: rgba(0, 0, 0, 0.1);\n}\n\n/* Grundlegende Styles */\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    line-height: 1.6;\n    color: var(--dark);\n    background-color: var(--light-gray);\n    padding-top: 0;\n    margin: 0;\n}\n\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 0 20px;\n}\n\n/* Top Navigation */\n.top-nav {\n    background: linear-gradient(135deg, var(--blue-sky) 0%, var(--blue-dark) 100%);\n    padding: 1rem 0;\n    box-shadow: 0 2px 10px var(--shadow);\n    margin-bottom: 2rem;\n}\n\n.top-nav nav {\n    display: flex;\n    gap: 1rem;\n    justify-content: flex-end;\n}\n\n.top-nav nav a {\n    color: var(--white);\n    text-decoration: none;\n    padding: 0.6rem 1.2rem;\n    border: 2px solid var(--white);\n    border-radius: 8px;\n    transition: all 0.3s;\n    font-weight: 600;\n    font-size: 1rem;\n}\n\n.top-nav nav a:hover {\n    background-color: var(--white);\n    color: var(--blue-dark);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n}\n\n/* Main Content */\nmain {\n    min-height: 70vh;\n    padding: 2rem 0;\n    margin-top: 0;\n}\n\nh2 {\n    font-size: 2rem;\n    margin-bottom: 1.5rem;\n    color: var(--dark);\n    border-bottom: 3px solid var(--blue-sky);\n    padding-bottom: 0.5rem;\n}\n\nh3 {\n    font-size: 1.5rem;\n    margin: 1.5rem 0 1rem 0;\n    color: var(--dark);\n}\n\nh4 {\n    font-size: 1.2rem;\n    margin: 1rem 0 0.5rem 0;\n    color: var(--dark);\n}\n\n/* Nachrichten / Flash Messages */\n.messages {\n    margin-bottom: 1.5rem;\n}\n\n.message {\n    padding: 1rem 1.5rem;\n    margin-bottom: 1rem;\n    border-radius: 8px;\n    font-weight: 500;\n    box-shadow: 0 2px 5px var(--shadow);\n}\n\n.message-success {\n    background-color: var(--green);\n    color: var(--white);\n    border-left: 5px solid #5A8A50;\n}\n\n.message-error {\n    background-color: #E74C3C;\n    color: var(--white);\n    border-left: 5px solid #C0392B;\n}\n\n.message-info {\n    background-color: var(--blue-sky);\n    color: var(--white);\n    border-left: 5px solid var(--blue-dark);\n}\n\n/* Formulare */\n.form-group {\n    margin-bottom: 1.2rem;\n}\n\n.form-group label {\n    display: block;\n    margin-bottom: 0.5rem;\n    font-weight: 600;\n    color: var(--dark);\n}\n\n.form-group input,\n.form-group select {\n    width: 100%;\n    padding: 0.8rem;\n    font-size: 1rem;\n    border: 2px solid var(--gray);\n    border-radius: 8px;\n    background-color: var(--white);\n    transition: all 0.3s;\n}\n\n.form-group input:focus,\n.form-group select:focus {\n    outline: none;\n    border-color: var(--blue-sky);\n    box-shadow: 0 0 0 3px rgba(93, 173, 226, 0.2);\n}\n\n.form-group input::placeholder {\n    color: var(--gray);\n}\n\n/* Buttons */\n.btn {\n    display: inline-block;\n    padding: 0.8rem 1.5rem;\n    text-decoration: none;\n    border: none;\n    border-radius: 8px;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s;\n    font-size: 1rem;\n}\n\n.btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px var(--shadow);\n}\n\n.btn-primary {\n    background-color: var(--blue-sky);\n    color: var(--white);\n}\n\n.btn-primary:hover {\n    background-color: var(--blue-dark);\n}\n\n.btn-secondary {\n    background-color: var(--gray);\n    color: var(--white);\n}\n\n.btn-secondary:hover {\n    background-color: #5D6D7E;\n}\n\n.btn-delete {\n    background-color: #E74C3C;\n    color: var(--white);\n    padding: 0.5rem 1rem;\n    font-size: 0.9rem;\n}\n\n.btn-delete:hover {\n    background-color: #C0392B;\n}\n\n.disabled {\n    color: var(--gray);\n    font-style: italic;\n}\n\n/* Login-Seite */\n.login-container {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    min-height: 70vh;\n    background: linear-gradient(135deg, var(--blue-sky) 0%, var(--blue-dark) 50%, var(--green) 100%);\n    margin: -2rem 0;\n    padding: 3rem 0;\n}\n\n.login-box {\n    border: none;\n    padding: 3rem;\n    max-width: 500px;\n    width: 100%;\n    background-color: var(--white);\n    border-radius: 20px;\n    box-shadow: 0 10px 40px rgba(0,0,0,0.3);\n    animation: fadeIn 0.5s ease-in;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(-20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.login-logo {\n    text-align: center;\n    margin-bottom: 2rem;\n}\n\n.login-logo img {\n    width: 150px;\n    height: 150px;\n    border-radius: 50%;\n    border: 5px solid var(--blue-sky);\n    box-shadow: 0 5px 20px rgba(0,0,0,0.2);\n    background: var(--white);\n}\n\n.login-box h2 {\n    text-align: center;\n    color: var(--dark);\n    font-size: 2.2rem;\n    margin-bottom: 2rem;\n    border-bottom: none;\n}\n\n.login-box .form-group input {\n    padding: 1rem;\n    font-size: 1.1rem;\n    border: 2px solid var(--light-gray);\n    transition: all 0.3s;\n}\n\n.login-box .form-group input:focus {\n    border-color: var(--blue-sky);\n    box-shadow: 0 0 0 4px rgba(93, 173, 226, 0.15);\n    transform: translateY(-2px);\n}\n\n.login-box .btn-primary {\n    width: 100%;\n    padding: 1.2rem;\n    font-size: 1.2rem;\n    font-weight: 700;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n    background: linear-gradient(135deg, var(--blue-sky) 0%, var(--blue-dark) 100%);\n    border: none;\n    margin-top: 1rem;\n}\n\n.login-box .btn-primary:hover {\n    background: linear-gradient(135deg, var(--blue-dark) 0%, var(--blue-sky) 100%);\n    transform: translateY(-3px);\n    box-shadow: 0 8px 20px rgba(93, 173, 226, 0.4);\n}\n\n.login-info {\n    margin-top: 2rem;\n    padding: 1.2rem;\n    border-radius: 10px;\n    background: linear-gradient(135deg, var(--sand-light) 0%, #FFF8E7 100%);\n    border: 2px solid var(--sand);\n    font-size: 0.95rem;\n    color: var(--dark);\n}\n\n.login-info p {\n    margin: 0.5rem 0;\n}\n\n.login-info strong {\n    color: var(--blue-dark);\n    font-size: 1.05rem;\n}\n\n/* Dashboard */\n.date-selector {\n    margin-bottom: 1.5rem;\n    padding: 1.5rem;\n    background-color: var(--white);\n    border-radius: 12px;\n    box-shadow: 0 2px 8px var(--shadow);\n}\n\n.date-selector label {\n    font-weight: 600;\n    margin-right: 1rem;\n    color: var(--dark);\n}\n\n.date-selector input {\n    padding: 0.7rem;\n    border: 2px solid var(--blue-sky);\n    border-radius: 8px;\n    font-size: 1rem;\n}\n\n.selected-date-info {\n    margin-bottom: 1.5rem;\n}\n\n.selected-date-info h3 {\n    background: linear-gradient(135deg, var(--blue-sky) 0%, var(--blue-dark) 100%);\n    color: var(--white);\n    padding: 1rem;\n    margin: 0;\n    border-radius: 8px;\n    text-align: center;\n}\n\n/* Wochenübersicht */\n.week-overview {\n    margin-bottom: 2rem;\n    background-color: var(--white);\n    padding: 1.5rem;\n    border-radius: 12px;\n    box-shadow: 0 2px 8px var(--shadow);\n}\n\n.week-table {\n    width: 100%;\n    border-collapse: collapse;\n    margin-top: 1rem;\n}\n\n.week-table th,\n.week-table td {\n    border: 2px solid var(--light-gray);\n    padding: 0.8rem;\n    text-align: center;\n    vertical-align: top;\n}\n\n.week-table th {\n    background: linear-gradient(135deg, var(--blue-dark) 0%, var(--blue-sky) 100%);\n    color: var(--white);\n    font-weight: 600;\n}\n\n.week-day-header {\n    display: flex;\n    flex-direction: column;\n    gap: 0.3rem;\n}\n\n.day-name {\n    font-size: 1.1rem;\n    font-weight: 700;\n    text-transform: uppercase;\n}\n\n.day-date {\n    font-size: 0.85rem;\n    opacity: 0.9;\n    font-weight: 400;\n}\n\n.week-table td {\n    font-size: 0.85rem;\n    min-height: 80px;\n}\n\n.period-header {\n    font-weight: 600;\n    margin-bottom: 0.5rem;\n    padding: 0.4rem;\n    border-radius: 6px;\n}\n\n.period-fest .period-header {\n    background: linear-gradient(135deg, var(--sand) 0%, var(--sand-light) 100%);\n    color: var(--dark);\n}\n\n.period-frei .period-header {\n    background: linear-gradient(135deg, var(--green) 0%, #A8D5BA 100%);\n    color: var(--white);\n}\n\n.booking-info {\n    margin-top: 0.5rem;\n    padding: 0.5rem;\n    background-color: rgba(255, 255, 255, 0.7);\n    border-radius: 5px;\n    font-size: 0.8rem;\n    text-align: left;\n    border-left: 3px solid var(--blue-sky);\n}\n\n.booking-info strong {\n    color: var(--blue-dark);\n}\n\n.period-fest {\n    background-color: #FFF8E7;\n    border-left: 4px solid var(--sand);\n}\n\n.period-frei {\n    background-color: #F0F9F4;\n    border-left: 4px solid var(--green);\n}\n\n/* Tagesplan-Tabelle */\n.day-schedule {\n    margin-top: 2rem;\n    background-color: var(--white);\n    padding: 1.5rem;\n    border-radius: 12px;\n    box-shadow: 0 2px 8px var(--shadow);\n}\n\n.schedule-table {\n    width: 100%;\n    border-collapse: collapse;\n    margin-top: 1rem;\n}\n\n.schedule-table th,\n.schedule-table td {\n    border: 2px solid var(--light-gray);\n    padding: 1rem;\n    text-align: left;\n}\n\n.schedule-table th {\n    background: linear-gradient(135deg, var(--dark) 0%, var(--gray) 100%);\n    color: var(--white);\n    font-weight: 600;\n}\n\n.schedule-table tr:nth-child(even) {\n    background-color: var(--light-gray);\n}\n\n.capacity {\n    font-weight: bold;\n    color: var(--green);\n}\n\n.capacity.full {\n    color: #E74C3C;\n    text-decoration: line-through;\n}\n\n/* Buchungsformular */\n.booking-form {\n    max-width: 800px;\n    background-color: var(--white);\n    padding: 2rem;\n    border-radius: 12px;\n    box-shadow: 0 2px 8px var(--shadow);\n}\n\n.booking-info {\n    background: linear-gradient(135deg, var(--sand-light) 0%, #FFF8E7 100%);\n    border: 2px solid var(--sand);\n    border-radius: 8px;\n    padding: 1.5rem;\n    margin-bottom: 2rem;\n}\n\n.booking-info p {\n    margin-bottom: 0.7rem;\n    font-size: 1.05rem;\n}\n\n.teacher-info-section {\n    background-color: var(--light-gray);\n    padding: 1.5rem;\n    border-radius: 8px;\n    margin-bottom: 1.5rem;\n    border-left: 5px solid var(--blue-sky);\n}\n\n.student-entry {\n    border: 2px solid var(--light-gray);\n    padding: 1.2rem;\n    margin-bottom: 1rem;\n    background-color: #FAFAFA;\n    border-radius: 8px;\n    border-left: 4px solid var(--orange);\n}\n\n.form-actions {\n    margin-top: 2rem;\n    padding-top: 1.5rem;\n    border-top: 2px solid var(--light-gray);\n    display: flex;\n    gap: 1rem;\n    flex-wrap: wrap;\n}\n\n/* Admin-Bereich */\n.admin-panel {\n    max-width: 1200px;\n}\n\n.admin-section {\n    margin-bottom: 3rem;\n    padding: 2rem;\n    background-color: var(--white);\n    border-radius: 12px;\n    box-shadow: 0 2px 8px var(--shadow);\n}\n\n.admin-form {\n    max-width: 600px;\n    background-color: var(--light-gray);\n    padding: 1.5rem;\n    border-radius: 8px;\n}\n\n.admin-table {\n    width: 100%;\n    border-collapse: collapse;\n    margin-top: 1rem;\n}\n\n.admin-table th,\n.admin-table td {\n    border: 2px solid var(--light-gray);\n    padding: 1rem;\n    text-align: left;\n}\n\n.admin-table th {\n    background: linear-gradient(135deg, var(--dark) 0%, var(--gray) 100%);\n    color: var(--white);\n}\n\n.admin-table tr:nth-child(even) {\n    background-color: var(--light-gray);\n}\n\n.role-badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 20px;\n    font-weight: 600;\n    font-size: 0.85rem;\n}\n\n.role-badge.admin {\n    background-color: var(--orange);\n    color: var(--white);\n}\n\n.role-badge.teacher {\n    background-color: var(--blue-sky);\n    color: var(--white);\n}\n\n.filter-form {\n    margin-bottom: 1.5rem;\n    padding: 1.2rem;\n    background-color: var(--light-gray);\n    border-radius: 8px;\n}\n\n.filter-form label {\n    font-weight: 600;\n    margin-right: 0.5rem;\n}\n\n.filter-form input {\n    padding: 0.6rem;\n    border: 2px solid var(--blue-sky);\n    border-radius: 8px;\n    margin-right: 0.5rem;\n}\n\n.bookings-table .student-list {\n    margin-top: 0.5rem;\n    padding-left: 1.5rem;\n    list-style-type: disc;\n}\n\n.no-data {\n    text-align: center;\n    font-style: italic;\n    color: var(--gray);\n}\n\n/* Footer */\nfooter {\n    background: linear-gradient(135deg, var(--dark) 0%, var(--gray) 100%);\n    color: var(--white);\n    padding: 1.5rem 0;\n    margin-top: 3rem;\n    text-align: center;\n}\n\n/* Responsive Design */\n@media (max-width: 768px) {\n    .top-nav nav {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .top-nav nav a {\n        text-align: center;\n    }\n    \n    .login-logo img {\n        width: 120px;\n        height: 120px;\n    }\n    \n    .week-table,\n    .schedule-table,\n    .admin-table {\n        font-size: 0.85rem;\n    }\n    \n    .week-table th,\n    .week-table td,\n    .schedule-table th,\n    .schedule-table td,\n    .admin-table th,\n    .admin-table td {\n        padding: 0.5rem;\n    }\n    \n    .btn {\n        display: block;\n        width: 100%;\n        margin-bottom: 0.5rem;\n        text-align: center;\n    }\n    \n    .form-actions {\n        flex-direction: column;\n    }\n}\n","size_bytes":12885},"replit.md":{"content":"# SportOase Buchungssystem\n\n## Overview\n\nSportOase Buchungssystem is a web-based booking management system for a school sports facility. The application enables teachers to book time slots for students (1-5 per slot) and provides administrators with management capabilities for teachers and bookings. The system includes a weekly schedule with fixed and flexible offerings, capacity controls, and email notifications for new bookings.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Template Engine**: Jinja2 (Flask templates)\n- Base template pattern for consistent layout across all pages\n- Simple HTML/CSS design with black-and-white color scheme\n- Responsive layout suitable for desktop and tablet devices\n- Key templates: login, dashboard (with weekly overview), booking form, admin panel\n\n**Static Assets**:\n- Minimal CSS in `/static/style.css` for clean, professional styling\n- No JavaScript frameworks - vanilla JS for dynamic form interactions (e.g., student field generation)\n\n### Backend Architecture\n\n**Web Framework**: Flask (Python 3.11)\n- Session-based authentication using Flask sessions\n- Decorator-based route protection (`@login_required`, `@admin_required`)\n- Timezone-aware datetime handling using `pytz` (Europe/Berlin)\n\n**Application Structure**:\n- `app.py`: Main application file containing all route handlers\n- `config.py`: Configuration settings for class periods, fixed/free offerings, and module options\n- `models.py`: Database interaction layer with SQLite\n- `email_service.py`: SMTP-based email notification service\n- `db_setup.py`: Database initialization script\n\n**Key Features**:\n- Role-based access control (teacher vs. admin)\n- Booking validation: 60-minute advance booking requirement, 5-student maximum capacity per slot\n- Weekly schedule display with fixed vs. flexible time slots with booking information (who booked, how many students)\n- Dynamic module selection for flexible time slots\n- Admin booking management: create, edit, and delete bookings with full validation\n- Capacity-aware editing that prevents overbooking\n\n### Data Storage\n\n**Database**: SQLite (`sportoase.db`)\n\n**Schema Design**:\n- `users` table: Stores user credentials and roles (teacher/admin)\n  - Password hashing using `werkzeug.security`\n  - Email-based authentication\n  - Role column with CHECK constraint (teacher/admin only)\n\n- `bookings` table: Stores all booking records\n  - Date and period (1-6) tracking\n  - Student information stored as JSON in `students_json` column\n  - Offer type classification (fest/frei)\n  - Foreign key relationship to users table\n  - Created timestamp for audit trail\n\n**Data Model Rationale**: \n- SQLite chosen for simplicity and Replit compatibility\n- JSON storage for student data provides flexibility for variable numbers of students per booking\n- Row factory pattern enables dictionary-like access to query results\n\n### Authentication & Authorization\n\n**Authentication Mechanism**: Session-based authentication\n- Flask server-side sessions with secret key\n- Hashed passwords (werkzeug's generate_password_hash/check_password_hash)\n- Login credentials: email + password\n\n**Authorization Levels**:\n- Teachers: Can create bookings, view dashboard\n- Admins: Full teacher permissions plus user management and booking overview\n\n**Session Management**:\n- User ID, email, and role stored in session\n- Decorator functions enforce authentication and authorization requirements\n- Logout clears session data\n\n### External Dependencies\n\n**SMTP Email Service**:\n- Environment variables for configuration: `SMTP_HOST`, `SMTP_PORT`, `SMTP_USER`, `SMTP_PASS`, `SMTP_FROM`, `ADMIN_EMAIL`\n- Graceful degradation: prints notifications to console when SMTP not configured\n- Purpose: Automated booking notifications to administrators and teachers\n\n**Python Packages**:\n- Flask: Web framework\n- pytz: Timezone handling (Europe/Berlin)\n- werkzeug: Password hashing utilities\n- smtplib & email.mime: Email functionality (standard library)\n\n**Configuration**:\n- Period times, fixed offerings, and free modules defined in `config.py`\n- Environment-based SMTP configuration for deployment flexibility\n- Default admin credentials created during database initialization\n\n## Recent Changes\n\n- 2024-11-14: Enhanced admin panel and week overview features\n  - **Admin Booking Management**: Added full CRUD operations for bookings (create, edit, delete)\n    - Admins can now create bookings on behalf of any teacher\n    - Admins can edit existing bookings with all validations\n    - Added capacity checks to prevent overbooking in admin workflows\n    - Implemented safe error handling for all user inputs\n  - **Week Plan Overview Enhancements**: \n    - Added booking information to weekly overview showing who booked each slot\n    - Display teacher names and student counts for each booking\n    - Week overview now shows total students per period\n  - **Data Safety Improvements**:\n    - Guarded all JSON parsing against invalid/missing data\n    - Added proper exception handling for form input validation\n    - Fixed sqlite3.Row object handling throughout the application\n  - Created `admin_edit_booking.html` template for admin booking form\n  - Added database functions: `get_booking_by_id`, `update_booking`, `get_bookings_for_week`\n\n- 2024-11-14: Initial implementation of complete SportOase booking system\n  - Created all core files (app.py, config.py, models.py, db_setup.py, email_service.py)\n  - Implemented authentication system with role-based access control\n  - Built dashboard with weekly schedule overview and booking availability display\n  - Created booking form with capacity validation and 60-minute advance requirement\n  - Developed admin panel for teacher management and booking overview\n  - Designed black-and-white responsive UI with all templates\n  - Configured workflow to run Flask app on port 5000\n  - Initialized database with default admin account (admin@sportoase.de / admin123)\n","size_bytes":6006},"db_setup.py":{"content":"# Skript zur Initialisierung der Datenbank\n# Dieses Skript erstellt die Datenbank und legt einen Admin-Benutzer an\n\nfrom models import init_db, create_user, get_user_by_email\n\ndef setup_database():\n    \"\"\"Initialisiert die Datenbank und erstellt einen Standard-Admin-Account\"\"\"\n    print(\"Initialisiere Datenbank...\")\n    init_db()\n    \n    # Prüfe, ob bereits ein Admin existiert\n    admin = get_user_by_email('sportoase@sportoase.de')\n    if not admin:\n        # Erstelle Standard-Admin\n        admin_id = create_user('sportoase@sportoase.de', 'mauro123', 'admin')\n        if admin_id:\n            print(f\"Admin-Account erstellt:\")\n            print(f\"  E-Mail: sportoase@sportoase.de\")\n            print(f\"  Passwort: mauro123\")\n        else:\n            print(\"Admin-Account konnte nicht erstellt werden.\")\n    else:\n        print(\"Admin-Account existiert bereits.\")\n    \n    print(\"\\nDatenbank-Setup abgeschlossen!\")\n    print(\"Sie können sich jetzt mit den Admin-Zugangsdaten anmelden.\")\n\nif __name__ == '__main__':\n    setup_database()\n","size_bytes":1045},"config.py":{"content":"# Konfigurationsdatei für die SportOase-Anwendung\n# Diese Datei enthält alle wichtigen Einstellungen wie Stundenpläne und Zeitangaben\n\nimport os\n\n# Zeitplan der Schulstunden (Beginn und Ende jeder Stunde)\n# Format: \"HH:MM\" für Start und Ende\nPERIOD_TIMES = {\n    1: {\"start\": \"07:50\", \"end\": \"08:35\"},\n    2: {\"start\": \"08:35\", \"end\": \"09:20\"},\n    3: {\"start\": \"09:40\", \"end\": \"10:25\"},\n    4: {\"start\": \"10:25\", \"end\": \"11:20\"},\n    5: {\"start\": \"11:40\", \"end\": \"12:25\"},\n    6: {\"start\": \"12:25\", \"end\": \"13:10\"}\n}\n\n# Feste Angebote pro Wochentag und Stunde\n# \"Mon\" = Montag, \"Tue\" = Dienstag, etc.\n# Wenn eine Stunde hier nicht aufgeführt ist, ist sie FREI (Lehrkraft wählt Modul)\nFIXED_OFFERS = {\n    \"Mon\": {  # Montag\n        1: \"Wochenstart-Aktivierung\",\n        3: \"Konflikt-Reset & Deeskalation\",\n        5: \"Koordinationszirkel\"\n    },\n    \"Tue\": {  # Dienstag - alle Stunden frei\n    },\n    \"Wed\": {  # Mittwoch\n        1: \"Sozialtraining / Gruppenreset\",\n        3: \"Aktivierung Mini-Fitness\",\n        5: \"Motorik-Parcours\"\n    },\n    \"Thu\": {  # Donnerstag\n        2: \"Konflikt-Reset\",\n        5: \"Trampolin + Balance\"\n    },\n    \"Fri\": {  # Freitag\n        2: \"Atem & Reflexion\",\n        4: \"Bodyscan Light\",\n        5: \"Ruhezone / Entspannung\"\n    }\n}\n\n# Module, die bei freien Stunden wählbar sind\nFREE_MODULES = [\n    \"Aktivierung\",\n    \"Regulation / Entspannung\",\n    \"Konflikt-Reset\",\n    \"Egal / flexibel\"\n]\n\n# Maximale Anzahl Schüler pro Stunde\nMAX_STUDENTS_PER_PERIOD = 5\n\n# Vorlaufzeit für Buchungen in Minuten\nBOOKING_ADVANCE_MINUTES = 60\n\n# SMTP-Konfiguration (aus Umgebungsvariablen)\nSMTP_HOST = os.environ.get('SMTP_HOST', 'smtp.example.com')\nSMTP_PORT = int(os.environ.get('SMTP_PORT', '587'))\nSMTP_USER = os.environ.get('SMTP_USER', '')\nSMTP_PASS = os.environ.get('SMTP_PASS', '')\nSMTP_FROM = os.environ.get('SMTP_FROM', 'sportoase@school.de')\nADMIN_EMAIL = os.environ.get('ADMIN_EMAIL', 'admin@school.de')\n\n# Flask Session Secret (aus Umgebungsvariable)\nSECRET_KEY = os.environ.get('SESSION_SECRET', 'dev-secret-key-change-in-production')\n\n# Datenbank-Pfad\nDATABASE_PATH = 'sportoase.db'\n","size_bytes":2128},"main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","size_bytes":96}},"version":2}